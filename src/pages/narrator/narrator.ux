<template>
  <div class="narrator-page">
    <!-- è®²è¿°äººé€‰æ‹©é¡µé¢ -->
    <div class="narrator-setup" show="{{ currentStage === 'narrator' }}">
      <text class="page-title">é€‰æ‹©æ•…äº‹è®²è¿°äºº</text>
      
      <div class="narrator-list">
        <div class="narrator-card {{ selectedNarrator === 'Cassandra' ? 'selected' : '' }}" onclick="selectNarrator('Cassandra')">
          <image class="narrator-image" src="/common/CassandraClassic.png"></image>
          <div class="narrator-info">
            <text class="narrator-name">å¡æ¡‘å¾·æ‹‰Â·ç»å…¸</text>
            <text class="narrator-desc">å¡æ¡‘å¾·æ‹‰æŒ‰ç…§ç»å…¸çš„æŒ‘æˆ˜å’Œç´§å¼ æ„Ÿé€’å¢æ›²çº¿åˆ›é€ æ•…äº‹äº‹ä»¶ã€‚å¥¹ä¼šç”¨å±é™©äº‹ä»¶æ¨åŠ¨ä½ ï¼Œç„¶åç»™ä½ å–˜æ¯çš„ç©ºé—´ï¼Œæ¥ç€å†æ¬¡å›æ¥æ¨åŠ¨ã€‚</text>
          </div>
        </div>
        
        <div class="narrator-card {{ selectedNarrator === 'Phoebe' ? 'selected' : '' }}" onclick="selectNarrator('Phoebe')">
          <image class="narrator-image" src="/common/PhoebeFriendly.png"></image>
          <div class="narrator-info">
            <text class="narrator-name">è²æ¯”Â·æ‚ é—²</text>
            <text class="narrator-desc">è²æ¯”åœ¨ç¾éš¾ä¹‹é—´ç»™ä½ å¤§é‡æ—¶é—´æ¥å»ºè®¾æ®–æ°‘åœ°ã€‚ä½†è¦å°å¿ƒâ€”â€”åœ¨é«˜éš¾åº¦ä¸‹ï¼Œå¥¹çš„æ‰“å‡»å’Œä»»ä½•äººä¸€æ ·çŒ›çƒˆã€‚</text>
          </div>
        </div>
        
        <div class="narrator-card {{ selectedNarrator === 'Randy' ? 'selected' : '' }}" onclick="selectNarrator('Randy')">
          <image class="narrator-image" src="/common/RandyRandom.png"></image>
          <div class="narrator-info">
            <text class="narrator-name">å…°è¿ªÂ·éšæœº</text>
            <text class="narrator-desc">å…°è¿ªä¸éµå¾ªè§„åˆ™ã€‚ä»–ä¼šç”Ÿæˆéšæœºäº‹ä»¶ï¼Œä¸åœ¨ä¹è¿™äº›äº‹ä»¶æ˜¯æ„æˆèƒœåˆ©è¿˜æ˜¯å½»åº•ç»æœ›çš„æ•…äº‹ã€‚å¯¹ä»–æ¥è¯´éƒ½æ˜¯æˆå‰§ã€‚è­¦å‘Šï¼šå…°è¿ªæœ‰æ—¶ä¼šå‘é€æå…¶å›°éš¾æˆ–ä¸å…¬å¹³çš„äº‹ä»¶ç»„åˆã€‚</text>
          </div>
        </div>
      </div>
      
      <div class="navigation">
        <input class="nav-btn" type="button" value="è¿”å›" onclick="backToColonist" />
        <input class="nav-btn primary" type="button" value="ä¸‹ä¸€é˜¶æ®µ" onclick="nextToStory" show="{{ selectedNarrator }}" />
        <text class="validation-hint" show="{{ !selectedNarrator }}">è¯·é€‰æ‹©ä¸€ä¸ªæ•…äº‹è®²è¿°äºº</text>
      </div>
    </div>
    
    <!-- æ•…äº‹é€‰æ‹©é¡µé¢ -->
    <div class="story-setup" show="{{ currentStage === 'story' }}">
      <text class="page-title">é€‰æ‹©æ•…äº‹ç±»å‹</text>
      
      <div class="story-list">
        <div class="story-card {{ selectedStory === 'Crashlanded' ? 'selected' : '' }}" onclick="selectStory('Crashlanded')">
          <text class="story-name">è¿«é™</text>
          <text class="story-desc">ä½ ä»¬ä¸‰äººåœ¨è­¦æŠ¥å£°å’Œé‡‘å±æ’•è£‚å£°ä¸­ä»å†·å†»ç¡çœ æ£ºä¸­é†’æ¥ã€‚åœ¨é£èˆ¹è¢«æ’•è£‚ä¹‹å‰ï¼Œä½ ä»¬å‹‰å¼ºåˆ°è¾¾äº†é€ƒç”Ÿèˆ±ã€‚ä¸€æ®µæ—¶é—´åï¼Œä½ ä»¬é™è½åœ¨è¿™ä¸ªæœªçŸ¥çš„è¾¹ç¼˜ä¸–ç•Œä¸Šã€‚</text>
        </div>
        
        <div class="story-card {{ selectedStory === 'RichExplorer' ? 'selected' : '' }}" onclick="selectStory('RichExplorer')">
          <text class="story-name">å¯Œæœ‰çš„æ¢é™©å®¶</text>
          <text class="story-desc">äººä»¬è¯´ä½ ç¦»å¼€é—ªå…‰ä¸–ç•Œçš„å®¶æ˜¯ç–¯äº†ï¼Œä½†ä½ æ€»æ˜¯æ¸´æœ›æ¢ç´¢æ˜Ÿç©ºâ€”â€”åœ¨ç¥ç»æ¨¡æ‹Ÿå™¨ä¹‹å¤–ã€‚ç°åœ¨ä½ åœ¨å†·å†»ç¡çœ ä¸­çš„é•¿é€”æ—…è¡Œå³å°†ç»“æŸï¼Œé™è½åœ¨ä¸€ä¸ªæœªçŸ¥çš„è¾¹ç¼˜ä¸–ç•Œä¸Šçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­ã€‚æ³¨æ„ï¼šç”±äºä½ çš„èµ·å§‹è§’è‰²å°†ç¼ºä¹æŸäº›æŠ€èƒ½ï¼Œè¿™åœ¨æ¸¸æˆæ—©æœŸæ˜¯ä¸€ä¸ªç‰¹åˆ«å›°éš¾çš„åœºæ™¯ã€‚</text>
        </div>
        
        <div class="story-card {{ selectedStory === 'NakedBrutality' ? 'selected' : '' }}" onclick="selectStory('NakedBrutality')">
          <text class="story-name">èµ¤è£¸çš„æš´è¡Œ</text>
          <text class="story-desc">ä½ å› ä¸ºä¸€ä¸ªå°æ‰‹æœ¯è€Œæ¥å—äº†éº»é†‰ã€‚ç°åœ¨ä½ åœ¨ä¸€ä¸ªå è½èˆ±ä¸­é†’æ¥ï¼Œæ’å‘ä¸€ä¸ªé¥è¿œçš„æ˜Ÿçƒã€‚ä½ èµ¤èº«è£¸ä½“ï¼Œå­¤èº«ä¸€äººï¼Œå®Œå…¨æ²¡æœ‰å‡†å¤‡ã€‚ä½ èƒ½ç”Ÿå­˜ä¸‹æ¥å—ï¼Ÿè­¦å‘Šï¼šè¿™ä¸ªåœºæ™¯æ²¡æœ‰ä»»ä½•å…¬å¹³å¯è¨€â€”â€”å®ƒæå…¶å›°éš¾ï¼Œæ­»äº¡å¯èƒ½å› ä¸ºä»»ä½•åŸå› å‘ç”Ÿã€‚</text>
        </div>
      </div>
      
      <div class="navigation">
        <input class="nav-btn" type="button" value="è¿”å›" onclick="backToNarrator" />
        <input class="nav-btn primary" type="button" value="å¼€å§‹æ¸¸æˆ" onclick="startGame" show="{{ selectedStory }}" />
        <text class="validation-hint" show="{{ !selectedStory }}">è¯·é€‰æ‹©ä¸€ä¸ªæ•…äº‹ç±»å‹</text>
      </div>
    </div>
  </div>
</template>

<script>
import router from "@system.router"

export default {
  props: {
    colonistData: {
      type: Object,
      default: () => ({})
    }
  },
  
  private: {
    currentStage: 'narrator', // 'narrator', 'story'
    
    // è®²è¿°äººé€‰æ‹©
    selectedNarrator: '',
    
    // æ•…äº‹é€‰æ‹©
    selectedStory: ''
  },
  
  onInit() {
    console.log('æ¥æ”¶åˆ°çš„æ®–æ°‘è€…æ•°æ®:', this.colonistData)
  },
  
  // è®²è¿°äººé€‰æ‹©æ–¹æ³•
  selectNarrator(narrator) {
    this.selectedNarrator = narrator
  },
  
  backToColonist() {
    router.push({
      uri: '/pages/colonist',
      params: {
        colonistData: this.colonistData
      }
    })
  },
  
  nextToStory() {
    this.currentStage = 'story'
  },
  
  // æ•…äº‹é€‰æ‹©æ–¹æ³•
  selectStory(story) {
    this.selectedStory = story
  },
  
  backToNarrator() {
    this.currentStage = 'narrator'
  },
  
  startGame() {
    // éªŒè¯å¿…è¦çš„é€‰æ‹©æ˜¯å¦å®Œæˆ
    if (!this.selectedNarrator) {
      console.log('âŒ è®²è¿°äººé€‰æ‹©éªŒè¯å¤±è´¥: æœªé€‰æ‹©è®²è¿°äºº')
      // è¿™é‡Œå¯ä»¥æ·»åŠ ç”¨æˆ·æç¤º
      return
    }
    
    if (!this.selectedStory) {
      console.log('âŒ æ•…äº‹é€‰æ‹©éªŒè¯å¤±è´¥: æœªé€‰æ‹©æ•…äº‹ç±»å‹')
      // è¿™é‡Œå¯ä»¥æ·»åŠ ç”¨æˆ·æç¤º
      return
    }
    
    // éªŒè¯æ®–æ°‘è€…æ•°æ®æ˜¯å¦å­˜åœ¨
    if (!this.colonistData) {
      console.log('âŒ æ¸¸æˆé…ç½®éªŒè¯å¤±è´¥: æ®–æ°‘è€…æ•°æ®ç¼ºå¤±')
      // è¿™é‡Œå¯ä»¥æ·»åŠ ç”¨æˆ·æç¤ºå¹¶è¿”å›æ®–æ°‘è€…é¡µé¢
      return
    }
    
    console.log('âœ… è®²è¿°äººå’Œæ•…äº‹é€‰æ‹©éªŒè¯é€šè¿‡ï¼Œå‡†å¤‡åˆ›å»ºæ¸¸æˆé…ç½®')
    
    // ç”Ÿæˆåˆå§‹åœ°å›¾
    console.log('ğŸ—ºï¸ å¼€å§‹ç”Ÿæˆåˆå§‹åœ°å›¾...')
    const terrainGenerator = require('../../common/terrainGenerator.js')
    const generatedTerrain = terrainGenerator.generateTerrain()
    
    // å°†åœ°å›¾æ•°æ®è½¬æ¢ä¸ºå­˜æ¡£æ ¼å¼
    const terrainGrid = []
    for (let y = 0; y < generatedTerrain.grid.length; y++) {
      terrainGrid[y] = []
      for (let x = 0; x < generatedTerrain.grid[y].length; x++) {
        const tile = generatedTerrain.grid[y][x]
        terrainGrid[y][x] = `[${x},${y}] - ${tile.biome}${tile.hill ? ` (${tile.hill})` : ''}${tile.object ? ` [${tile.object}]` : ''}`
      }
    }
    
    console.log('âœ… åˆå§‹åœ°å›¾ç”Ÿæˆå®Œæˆ:', {
      biome: generatedTerrain.biome,
      playerPosition: generatedTerrain.playerPosition,
      gridSize: `${generatedTerrain.grid.length}x${generatedTerrain.grid[0].length}`
    })
    
    // éªŒè¯ç”Ÿæˆçš„åœ°å›¾æ•°æ®å®Œæ•´æ€§
    console.log('ğŸ” å¼€å§‹éªŒè¯é¢„ç”Ÿæˆåœ°å›¾æ•°æ®å®Œæ•´æ€§...')
    
    if (!generatedTerrain) {
      console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: generatedTerrainä¸ºç©º')
      return
    }
    
    if (!generatedTerrain.grid || !Array.isArray(generatedTerrain.grid) || generatedTerrain.grid.length === 0) {
      console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: gridæ•°æ®æ— æ•ˆ', {
        hasGrid: !!generatedTerrain.grid,
        isArray: Array.isArray(generatedTerrain.grid),
        length: generatedTerrain.grid ? generatedTerrain.grid.length : 0
      })
      return
    }
    
    if (!generatedTerrain.biome || typeof generatedTerrain.biome !== 'string') {
      console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: biomeæ•°æ®æ— æ•ˆ', {
        hasBiome: !!generatedTerrain.biome,
        biomeType: typeof generatedTerrain.biome,
        biomeValue: generatedTerrain.biome
      })
      return
    }
    
    if (!generatedTerrain.playerPosition || 
        typeof generatedTerrain.playerPosition.x !== 'number' || 
        typeof generatedTerrain.playerPosition.y !== 'number') {
      console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: playerPositionæ•°æ®æ— æ•ˆ', {
        hasPlayerPosition: !!generatedTerrain.playerPosition,
        playerPosition: generatedTerrain.playerPosition
      })
      return
    }
    
    // éªŒè¯ç©å®¶ä½ç½®æ˜¯å¦åœ¨ç½‘æ ¼èŒƒå›´å†…
    const gridWidth = generatedTerrain.grid[0].length
    const gridHeight = generatedTerrain.grid.length
    if (generatedTerrain.playerPosition.x < 0 || 
        generatedTerrain.playerPosition.x >= gridWidth ||
        generatedTerrain.playerPosition.y < 0 || 
        generatedTerrain.playerPosition.y >= gridHeight) {
      console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: ç©å®¶ä½ç½®è¶…å‡ºç½‘æ ¼èŒƒå›´', {
        playerPosition: generatedTerrain.playerPosition,
        gridSize: `${gridWidth}x${gridHeight}`
      })
      return
    }
    
    // éªŒè¯ç½‘æ ¼ä¸­æ¯ä¸ªåœ°å—çš„æ•°æ®ç»“æ„
    for (let y = 0; y < generatedTerrain.grid.length; y++) {
      for (let x = 0; x < generatedTerrain.grid[y].length; x++) {
        const tile = generatedTerrain.grid[y][x]
        if (!tile || !tile.biome) {
          console.log('âŒ åœ°å›¾æ•°æ®éªŒè¯å¤±è´¥: åœ°å—æ•°æ®æ— æ•ˆ', {
            position: `[${x},${y}]`,
            tile: tile
          })
          return
        }
      }
    }
    
    console.log('âœ… é¢„ç”Ÿæˆåœ°å›¾æ•°æ®éªŒè¯é€šè¿‡ï¼Œæ•°æ®ç»“æ„å®Œæ•´')
    
    // åˆ›å»ºå®Œæ•´çš„æ¸¸æˆé…ç½®æ•°æ®
    const gameConfig = {
      // æ®–æ°‘è€…æ•°æ®
      colonist: this.colonistData,
      
      // è®²è¿°äººé…ç½®
      narrator: {
        type: this.selectedNarrator,
        name: this.getNarratorName(this.selectedNarrator),
        description: this.getNarratorDescription(this.selectedNarrator),
        difficulty: this.getNarratorDifficulty(this.selectedNarrator),
        eventFrequency: this.getNarratorEventFrequency(this.selectedNarrator)
      },
      
      // æ•…äº‹é…ç½®
      story: {
        type: this.selectedStory,
        name: this.getStoryName(this.selectedStory),
        description: this.getStoryDescription(this.selectedStory),
        startingResources: this.getStartingResources(this.selectedStory),
        startingColonists: this.getStartingColonists(this.selectedStory),
        difficulty: this.getStoryDifficulty(this.selectedStory)
      },
      
      // æ¸¸æˆè®¾ç½®
      gameSettings: {
        difficulty: 'normal',
        permadeath: false,
        autoSave: true,
        pauseOnLoad: true
      },
      
      // é¢„ç”Ÿæˆçš„åœ°å›¾æ•°æ®
      preGeneratedTerrain: {
        grid: generatedTerrain.grid,
        biome: generatedTerrain.biome,
        playerPosition: generatedTerrain.playerPosition,
        terrainGrid: terrainGrid
      },
      
      // åˆ›å»ºæ—¶é—´
      createdAt: Date.now()
    }
    
    console.log('ğŸ“¦ æ¸¸æˆé…ç½®æ•°æ®åˆ›å»ºå®Œæˆ:', {
      colonist: gameConfig.colonist.name,
      narrator: gameConfig.narrator.name,
      story: gameConfig.story.name,
      hasPreGeneratedTerrain: !!gameConfig.preGeneratedTerrain,
      createdAt: new Date(gameConfig.createdAt).toLocaleString()
    })
    
    // æœ€ç»ˆéªŒè¯preGeneratedTerrainæ•°æ®å®Œæ•´æ€§
    console.log('ğŸ” æœ€ç»ˆéªŒè¯preGeneratedTerrainæ•°æ®å®Œæ•´æ€§...')
    
    if (!gameConfig.preGeneratedTerrain) {
      console.log('âŒ æœ€ç»ˆéªŒè¯å¤±è´¥: preGeneratedTerrainå¯¹è±¡ä¸ºç©º')
      return
    }
    
    if (!gameConfig.preGeneratedTerrain.grid || !Array.isArray(gameConfig.preGeneratedTerrain.grid)) {
      console.log('âŒ æœ€ç»ˆéªŒè¯å¤±è´¥: preGeneratedTerrain.gridæ— æ•ˆ', {
        hasGrid: !!gameConfig.preGeneratedTerrain.grid,
        isArray: Array.isArray(gameConfig.preGeneratedTerrain.grid),
        gridType: typeof gameConfig.preGeneratedTerrain.grid
      })
      return
    }
    
    if (!gameConfig.preGeneratedTerrain.biome) {
      console.log('âŒ æœ€ç»ˆéªŒè¯å¤±è´¥: preGeneratedTerrain.biomeæ— æ•ˆ', {
        biome: gameConfig.preGeneratedTerrain.biome
      })
      return
    }
    
    if (!gameConfig.preGeneratedTerrain.playerPosition) {
      console.log('âŒ æœ€ç»ˆéªŒè¯å¤±è´¥: preGeneratedTerrain.playerPositionæ— æ•ˆ', {
        playerPosition: gameConfig.preGeneratedTerrain.playerPosition
      })
      return
    }
    
    console.log('âœ… æœ€ç»ˆéªŒè¯é€šè¿‡ï¼ŒpreGeneratedTerrainæ•°æ®å®Œæ•´:', {
      gridSize: `${gameConfig.preGeneratedTerrain.grid.length}x${gameConfig.preGeneratedTerrain.grid[0].length}`,
      biome: gameConfig.preGeneratedTerrain.biome,
      playerPosition: gameConfig.preGeneratedTerrain.playerPosition,
      hasTerrainGrid: !!gameConfig.preGeneratedTerrain.terrainGrid
    })
    
    // è·³è½¬åˆ°æ¸¸æˆé¡µé¢
    console.log('ğŸš€ æ­£åœ¨è·³è½¬åˆ°æ¸¸æˆé¡µé¢...')
    router.push({
      uri: '/pages/game',
      params: gameConfig
    })
  },
  
  // è·å–è®²è¿°äººä¿¡æ¯çš„è¾…åŠ©æ–¹æ³•
  getNarratorName(type) {
    const names = {
      'Cassandra': 'å¡æ¡‘å¾·æ‹‰Â·ç»å…¸',
      'Phoebe': 'è²æ¯”Â·æ‚ é—²',
      'Randy': 'å…°è¿ªÂ·éšæœº'
    }
    return names[type] || 'æœªçŸ¥è®²è¿°äºº'
  },
  
  getNarratorDescription(type) {
    const descriptions = {
      'Cassandra': 'å¡æ¡‘å¾·æ‹‰æŒ‰ç…§ç»å…¸çš„æŒ‘æˆ˜å’Œç´§å¼ æ„Ÿé€’å¢æ›²çº¿åˆ›é€ æ•…äº‹äº‹ä»¶ã€‚å¥¹ä¼šç”¨å±é™©äº‹ä»¶æ¨åŠ¨ä½ ï¼Œç„¶åç»™ä½ å–˜æ¯çš„ç©ºé—´ï¼Œæ¥ç€å†æ¬¡å›æ¥æ¨åŠ¨ã€‚',
      'Phoebe': 'è²æ¯”åœ¨ç¾éš¾ä¹‹é—´ç»™ä½ å¤§é‡æ—¶é—´æ¥å»ºè®¾æ®–æ°‘åœ°ã€‚ä½†è¦å°å¿ƒâ€”â€”åœ¨é«˜éš¾åº¦ä¸‹ï¼Œå¥¹çš„æ‰“å‡»å’Œä»»ä½•äººä¸€æ ·çŒ›çƒˆã€‚',
      'Randy': 'å…°è¿ªä¸éµå¾ªè§„åˆ™ã€‚ä»–ä¼šç”Ÿæˆéšæœºäº‹ä»¶ï¼Œä¸åœ¨ä¹è¿™äº›äº‹ä»¶æ˜¯æ„æˆèƒœåˆ©è¿˜æ˜¯å½»åº•ç»æœ›çš„æ•…äº‹ã€‚å¯¹ä»–æ¥è¯´éƒ½æ˜¯æˆå‰§ã€‚è­¦å‘Šï¼šå…°è¿ªæœ‰æ—¶ä¼šå‘é€æå…¶å›°éš¾æˆ–ä¸å…¬å¹³çš„äº‹ä»¶ç»„åˆã€‚'
    }
    return descriptions[type] || ''
  },
  
  getNarratorDifficulty(type) {
    const difficulties = {
      'Cassandra': 'balanced',
      'Phoebe': 'easy',
      'Randy': 'chaotic'
    }
    return difficulties[type] || 'normal'
  },
  
  getNarratorEventFrequency(type) {
    const frequencies = {
      'Cassandra': 'normal',
      'Phoebe': 'low',
      'Randy': 'random'
    }
    return frequencies[type] || 'normal'
  },
  
  // è·å–æ•…äº‹ä¿¡æ¯çš„è¾…åŠ©æ–¹æ³•
  getStoryName(type) {
    const names = {
      'Crashlanded': 'è¿«é™',
      'RichExplorer': 'å¯Œæœ‰çš„æ¢é™©å®¶',
      'NakedBrutality': 'èµ¤è£¸çš„æš´è¡Œ'
    }
    return names[type] || 'æœªçŸ¥æ•…äº‹'
  },
  
  getStoryDescription(type) {
    const descriptions = {
      'Crashlanded': 'ä½ ä»¬ä¸‰äººåœ¨è­¦æŠ¥å£°å’Œé‡‘å±æ’•è£‚å£°ä¸­ä»å†·å†»ç¡çœ æ£ºä¸­é†’æ¥ã€‚åœ¨é£èˆ¹è¢«æ’•è£‚ä¹‹å‰ï¼Œä½ ä»¬å‹‰å¼ºåˆ°è¾¾äº†é€ƒç”Ÿèˆ±ã€‚ä¸€æ®µæ—¶é—´åï¼Œä½ ä»¬é™è½åœ¨è¿™ä¸ªæœªçŸ¥çš„è¾¹ç¼˜ä¸–ç•Œä¸Šã€‚',
      'RichExplorer': 'äººä»¬è¯´ä½ ç¦»å¼€é—ªå…‰ä¸–ç•Œçš„å®¶æ˜¯ç–¯äº†ï¼Œä½†ä½ æ€»æ˜¯æ¸´æœ›æ¢ç´¢æ˜Ÿç©ºâ€”â€”åœ¨ç¥ç»æ¨¡æ‹Ÿå™¨ä¹‹å¤–ã€‚ç°åœ¨ä½ åœ¨å†·å†»ç¡çœ ä¸­çš„é•¿é€”æ—…è¡Œå³å°†ç»“æŸï¼Œé™è½åœ¨ä¸€ä¸ªæœªçŸ¥çš„è¾¹ç¼˜ä¸–ç•Œä¸Šçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­ã€‚æ³¨æ„ï¼šç”±äºä½ çš„èµ·å§‹è§’è‰²å°†ç¼ºä¹æŸäº›æŠ€èƒ½ï¼Œè¿™åœ¨æ¸¸æˆæ—©æœŸæ˜¯ä¸€ä¸ªç‰¹åˆ«å›°éš¾çš„åœºæ™¯ã€‚',
      'NakedBrutality': 'ä½ å› ä¸ºä¸€ä¸ªå°æ‰‹æœ¯è€Œæ¥å—äº†éº»é†‰ã€‚ç°åœ¨ä½ åœ¨ä¸€ä¸ªå è½èˆ±ä¸­é†’æ¥ï¼Œæ’å‘ä¸€ä¸ªé¥è¿œçš„æ˜Ÿçƒã€‚ä½ èµ¤èº«è£¸ä½“ï¼Œå­¤èº«ä¸€äººï¼Œå®Œå…¨æ²¡æœ‰å‡†å¤‡ã€‚ä½ èƒ½ç”Ÿå­˜ä¸‹æ¥å—ï¼Ÿè­¦å‘Šï¼šè¿™ä¸ªåœºæ™¯æ²¡æœ‰ä»»ä½•å…¬å¹³å¯è¨€â€”â€”å®ƒæå…¶å›°éš¾ï¼Œæ­»äº¡å¯èƒ½å› ä¸ºä»»ä½•åŸå› å‘ç”Ÿã€‚'
    }
    return descriptions[type] || ''
  },
  
  getStartingResources(type) {
    const resources = {
      'Crashlanded': {
        food: 75,
        medicine: 30,
        steel: 450,
        wood: 300,
        silver: 800,
        components: 25
      },
      'RichExplorer': {
        food: 30,
        medicine: 50,
        steel: 200,
        wood: 100,
        silver: 2500,
        components: 50,
        gold: 100
      },
      'NakedBrutality': {
        food: 0,
        medicine: 0,
        steel: 0,
        wood: 0,
        silver: 0,
        components: 0
      }
    }
    return resources[type] || {}
  },
  
  getStartingColonists(type) {
    const colonists = {
      'Crashlanded': 3,
      'RichExplorer': 1,
      'NakedBrutality': 1
    }
    return colonists[type] || 1
  },
  
  getStoryDifficulty(type) {
    const difficulties = {
      'Crashlanded': 'normal',
      'RichExplorer': 'hard',
      'NakedBrutality': 'extreme'
    }
    return difficulties[type] || 'normal'
  }
}
</script>

<style>
.narrator-page {
  flex-direction: column;
  background-image: url('/common/MindbendCarpet_a_512.png');
  background-size: cover;
  width: 100%;
  min-height: 100%;
  padding: 10px;
}

.page-title {
  font-size: 20px;
  color: #ffffff;
  text-align: center;
  margin-bottom: 15px;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
}

/* è®²è¿°äººé€‰æ‹©æ ·å¼ */
.narrator-setup {
  flex-direction: column;
  width: 100%;
  min-height: 100%;
  justify-content: flex-start;
}

.narrator-list {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding-top: 10px;
  padding-bottom: 20px;
}

.narrator-card {
  width: 320px;
  margin-bottom: 15px;
  padding: 15px;
  background-color: rgba(0,0,0,0.7);
  border-radius: 8px;
  border: 2px solid #8B4513;
  flex-direction: column;
  align-items: center;
  min-height: 180px;
}

.narrator-card.selected {
  border-color: #228B22;
  background-color: rgba(34, 139, 34, 0.3);
}

.narrator-image {
  width: 90px;
  height: 90px;
  margin-bottom: 12px;
  border-radius: 4px;
  object-fit: contain;
}

.narrator-info {
  width: 100%;
  flex-direction: column;
  align-items: center;
  flex: 1;
}

.narrator-name {
  font-size: 16px;
  color: #ffffff;
  margin-bottom: 10px;
  font-weight: bold;
  text-align: center;
}

.narrator-desc {
  font-size: 12px;
  color: #cccccc;
  line-height: 1.4;
  text-align: center;
  word-wrap: break-word;
  flex: 1;
}

/* æ•…äº‹é€‰æ‹©æ ·å¼ */
.story-setup {
  flex-direction: column;
  width: 100%;
  min-height: 100%;
  justify-content: flex-start;
}

.story-list {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  padding-top: 10px;
  padding-bottom: 20px;
}

.story-card {
  width: 320px;
  margin-bottom: 15px;
  padding: 15px;
  background-color: rgba(0,0,0,0.7);
  border-radius: 8px;
  border: 2px solid #8B4513;
  flex-direction: column;
  align-items: center;
  min-height: 120px;
}

.story-card.selected {
  border-color: #228B22;
  background-color: rgba(34, 139, 34, 0.3);
}

.story-name {
  font-size: 16px;
  color: #ffffff;
  margin-bottom: 12px;
  font-weight: bold;
  text-align: center;
}

.story-desc {
  font-size: 12px;
  color: #cccccc;
  line-height: 1.4;
  text-align: center;
  word-wrap: break-word;
  flex: 1;
}

/* å¯¼èˆªæŒ‰é’®æ ·å¼ */
.navigation {
  flex-direction: row;
  justify-content: center;
  margin-top: 20px;
  margin-bottom: 20px;
  padding-bottom: 10px;
}

.nav-btn {
  width: 100px;
  height: 40px;
  margin: 0 10px;
  border-radius: 6px;
  background-color: rgba(139, 69, 19, 0.8);
  font-size: 14px;
  color: #ffffff;
  border: 2px solid #8B4513;
  text-align: center;
}

.nav-btn.primary {
  background-color: rgba(34, 139, 34, 0.8);
  border-color: #228B22;
}

.nav-btn.primary {
  background-color: #32CD32;
  border-color: #228B22;
}

.validation-hint {
  font-size: 12px;
  color: #FFD700;
  text-align: center;
  margin-top: 10px;
  padding: 5px;
  background-color: rgba(255, 215, 0, 0.1);
  border-radius: 4px;
  border: 1px solid #FFD700;
}
</style>